!function(e,t,n,i){"use strict";e.fn.form=function(t,r){var a,o=e(this),s=e.extend(!0,{},e.fn.form.settings,r),l=e.extend({},e.fn.form.settings.defaults,t),f=s.namespace,c=s.metadata,u=s.selector,d=s.className,m=(s.error,"."+f),p="module-"+f,v=o.selector||"",g=(new Date).getTime(),h=[],b=arguments[0],k="string"==typeof b,y=[].slice.call(arguments,1);return o.each(function(){var t,r=e(this),f=e(this).find(u.field),D=e(this).find(u.group),x=e(this).find(u.message),w=(e(this).find(u.prompt),e(this).find(u.submit)),E=e(this).find(u.clear),C=e(this).find(u.reset),S=[],O=!1,z=this,R=r.data(p);t={initialize:function(){t.verbose("Initializing form validation",r,l,s),t.bindEvents(),t.set.defaults(),t.instantiate()},instantiate:function(){t.verbose("Storing instance of module",t),R=t,r.data(p,t)},destroy:function(){t.verbose("Destroying previous module",R),t.removeEvents(),r.removeData(p)},refresh:function(){t.verbose("Refreshing selector cache"),f=r.find(u.field)},submit:function(){t.verbose("Submitting form",r),r.submit()},attachEvents:function(n,i){i=i||"submit",e(n).on("click",function(e){t[i](),e.preventDefault()})},bindEvents:function(){s.keyboardShortcuts&&f.on("keydown"+m,t.event.field.keydown),r.on("submit"+m,t.validate.form),f.on("blur"+m,t.event.field.blur),t.attachEvents(w,"submit"),t.attachEvents(C,"reset"),t.attachEvents(E,"clear"),f.each(function(){var n=e(this).prop("type"),i=t.get.changeEvent(n);e(this).on(i+m,t.event.field.change)})},clear:function(){f.each(function(){var n=e(this),i=n.parent(),r=n.closest(D),a=r.find(u.prompt),o=n.data(c.defaultValue)||"",s=i.is(u.uiCheckbox),l=i.is(u.uiDropdown),f=r.hasClass(d.error);f&&(t.verbose("Resetting error on field",r),r.removeClass(d.error),a.remove()),l?(t.verbose("Resetting dropdown value",i,o),i.dropdown("clear")):s?i.checkbox("uncheck"):(t.verbose("Resetting field value",n,o),n.val(""))})},reset:function(){f.each(function(){var n=e(this),i=n.parent(),r=n.closest(D),a=r.find(u.prompt),o=n.data(c.defaultValue)||"",s=i.is(u.uiCheckbox),l=i.is(u.uiDropdown),f=r.hasClass(d.error);f&&(t.verbose("Resetting error on field",r),r.removeClass(d.error),a.remove()),l?(t.verbose("Resetting dropdown value",i,o),i.dropdown("restore defaults")):s?(t.verbose("Resetting checkbox value",i,o),i.checkbox(o===!0?"check":"uncheck")):(t.verbose("Resetting field value",n,o),n.val(o))})},removeEvents:function(){r.off(m),f.off(m),w.off(m),f.off(m)},event:{field:{keydown:function(n){var i=e(this),r=n.which,a={enter:13,escape:27};r==a.escape&&(t.verbose("Escape key pressed blurring field"),i.blur()),!n.ctrlKey&&r==a.enter&&i.is(u.input)&&i.not(u.checkbox).length>0&&(w.addClass(d.pressed),O||(i.one("keyup"+m,t.event.field.keyup),t.submit(),t.debug("Enter pressed on input submitting form")),O=!0)},keyup:function(){O=!1,w.removeClass(d.pressed)},blur:function(){var n=e(this),i=n.closest(D);i.hasClass(d.error)?(t.debug("Revalidating field",n,t.get.validation(n)),t.validate.field(t.get.validation(n))):("blur"==s.on||"change"==s.on)&&t.validate.field(t.get.validation(n))},change:function(){var n=e(this),i=n.closest(D);("change"==s.on||i.hasClass(d.error)&&s.revalidate)&&(clearTimeout(t.timer),t.timer=setTimeout(function(){t.debug("Revalidating field",n,t.get.validation(n)),t.validate.field(t.get.validation(n))},s.delay))}}},get:{changeEvent:function(e){return"checkbox"==e||"radio"==e||"hidden"==e?"change":t.get.inputEvent()},inputEvent:function(){return n.createElement("input").oninput!==i?"input":n.createElement("input").onpropertychange!==i?"propertychange":"keyup"},field:function(n){return t.verbose("Finding field with identifier",n),f.filter("#"+n).length>0?f.filter("#"+n):f.filter('[name="'+n+'"]').length>0?f.filter('[name="'+n+'"]'):f.filter('[name="'+n+'[]"]').length>0?f.filter('[name="'+n+'[]"]'):f.filter("[data-"+c.validate+'="'+n+'"]').length>0?f.filter("[data-"+c.validate+'="'+n+'"]'):e("<input/>")},fields:function(n){var i=e();return e.each(n,function(e,n){i=i.add(t.get.field(n))}),i},validation:function(n){var i;return e.each(l,function(e,r){t.get.field(r.identifier).get(0)==n.get(0)&&(i=r)}),i||!1},value:function(e){var n,i=[];return i.push(e),n=t.get.values.call(z,i),n[e]},values:function(n){var i=e.isArray(n)?t.get.fields(n):f,r={};return i.each(function(n,i){var a=e(i),o=(a.prop("type"),a.prop("name")),s=a.val(),l=a.is(u.checkbox),f=a.is(u.radio),c=-1!==o.indexOf("[]"),d=l?a.is(":checked"):!1;if(o)if(c)if(o=o.replace("[]",""),r[o]||(r[o]=[]),l){if(!d)return t.debug("Omitted unchecked checkbox",a),!0;r[o].push(s)}else r[o].push(s);else if(f)d&&(r[o]=s);else if(l){if(!d)return t.debug("Omitted unchecked checkbox",a),!0;r[o]=!0}else r[o]=s}),r}},has:{field:function(e){return t.verbose("Checking for existence of a field with identifier",e),f.filter("#"+e).length>0?!0:f.filter('[name="'+e+'"]').length>0?!0:f.filter("[data-"+c.validate+'="'+e+'"]').length>0?!0:!1}},add:{prompt:function(n,a){var o=t.get.field(n),l=o.closest(D),f=l.children(u.prompt),c=0!==f.length;a="string"==typeof a?[a]:a,t.verbose("Adding field error state",n),l.addClass(d.error),s.inline&&(c||(f=s.templates.prompt(a),f.appendTo(l)),f.html(a[0]),c?t.verbose("Inline errors are disabled, no inline error added",n):s.transition&&e.fn.transition!==i&&r.transition("is supported")?(t.verbose("Displaying error with css transition",s.transition),f.transition(s.transition+" in",s.duration)):(t.verbose("Displaying error with fallback javascript animation"),f.fadeIn(s.duration)))},errors:function(e){t.debug("Adding form error messages",e),x.html(s.templates.error(e))}},remove:{prompt:function(n){var a=t.get.field(n.identifier),o=a.closest(D),l=o.children(u.prompt);o.removeClass(d.error),s.inline&&l.is(":visible")&&(t.verbose("Removing prompt for field",n),s.transition&&e.fn.transition!==i&&r.transition("is supported")?l.transition(s.transition+" out",s.duration,function(){l.remove()}):l.fadeOut(s.duration,function(){l.remove()}))}},set:{success:function(){r.removeClass(d.error).addClass(d.success)},defaults:function(){f.each(function(){var t=e(this),n=t.filter(u.checkbox).length>0,i=n?t.is(":checked"):t.val();t.data(c.defaultValue,i)})},error:function(){r.removeClass(d.success).addClass(d.error)},value:function(e,n){var i={};return i[e]=n,t.set.values.call(z,i)},values:function(n){e.isEmptyObject(n)||(e.each(n,function(n,i){var r,a=t.get.field(n),o=a.parent(),s=e.isArray(i),l=o.is(u.uiCheckbox),f=o.is(u.uiDropdown),c=a.is(u.radio)&&l,d=a.length>0;d&&(s&&l?(t.verbose("Selecting multiple",i,a),o.checkbox("uncheck"),e.each(i,function(e,t){r=a.filter('[value="'+t+'"]'),o=r.parent(),r.length>0&&o.checkbox("check")})):c?(t.verbose("Selecting radio value",i,a),a.filter('[value="'+i+'"]').parent(u.uiCheckbox).checkbox("check")):l?(t.verbose("Setting checkbox value",i,o),o.checkbox(i===!0?"check":"uncheck")):f?(t.verbose("Setting dropdown value",i,o),o.dropdown("set selected",i)):(t.verbose("Setting field value",i,a),a.val(i)))}),t.validate.form())}},validate:{form:function(n){var a=!0;return O?!1:(S=[],e.each(l,function(e,n){t.validate.field(n)||(a=!1)}),a?(t.debug("Form has no validation errors, submitting"),t.set.success(),s.onSuccess.call(z,n)):(t.debug("Form has errors"),t.set.error(),s.inline||t.add.errors(S),r.data("moduleApi")!==i&&n.stopImmediatePropagation(),s.onFailure.call(z,S)))},field:function(n){var r=t.get.field(n.identifier),a=!0,o=[];return r.prop("disabled")?(t.debug("Field is disabled. Skipping",n.identifier),a=!0):n.optional&&""===e.trim(r.val())?(t.debug("Field is optional and empty. Skipping",n.identifier),a=!0):n.rules!==i&&e.each(n.rules,function(e,i){t.has.field(n.identifier)&&!t.validate.rule(n,i)&&(t.debug("Field is invalid",n.identifier,i.type),o.push(i.prompt),a=!1)}),a?(t.remove.prompt(n,o),s.onValid.call(r),!0):(S=S.concat(o),t.add.prompt(n.identifier,o),s.onInvalid.call(r,o),!1)},rule:function(n,r){var a,o,l=t.get.field(n.identifier),f=r.type,c=e.trim(l.val()+""),u=/\[(.*)\]/i,d=u.exec(f),m=!0;return d!==i&&null!==d?(a=""+d[1],o=f.replace(d[0],""),m=s.rules[o].call(z,c,a)):m=s.rules[f].call(l,c),m}},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,s,t);else{if(n===i)return s[t];s[t]=n}},internal:function(n,r){if(e.isPlainObject(n))e.extend(!0,t,n);else{if(r===i)return t[n];t[n]=r}},debug:function(){s.debug&&(s.performance?t.performance.log(arguments):(t.debug=Function.prototype.bind.call(console.info,console,s.name+":"),t.debug.apply(console,arguments)))},verbose:function(){s.verbose&&s.debug&&(s.performance?t.performance.log(arguments):(t.verbose=Function.prototype.bind.call(console.info,console,s.name+":"),t.verbose.apply(console,arguments)))},error:function(){t.error=Function.prototype.bind.call(console.error,console,s.name+":"),t.error.apply(console,arguments)},performance:{log:function(e){var n,i,r;s.performance&&(n=(new Date).getTime(),r=g||n,i=n-r,g=n,h.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:z,"Execution Time":i})),clearTimeout(t.performance.timer),t.performance.timer=setTimeout(t.performance.display,100)},display:function(){var n=s.name+":",r=0;g=!1,clearTimeout(t.performance.timer),e.each(h,function(e,t){r+=t["Execution Time"]}),n+=" "+r+"ms",v&&(n+=" '"+v+"'"),o.length>1&&(n+=" ("+o.length+")"),(console.group!==i||console.table!==i)&&h.length>0&&(console.groupCollapsed(n),console.table?console.table(h):e.each(h,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),h=[]}},invoke:function(t,n,r){var o,s,l,f=R;return n=n||y,r=z||r,"string"==typeof t&&f!==i&&(t=t.split(/[\. ]/),o=t.length-1,e.each(t,function(n,r){var a=n!=o?r+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(f[a])&&n!=o)f=f[a];else{if(f[a]!==i)return s=f[a],!1;if(!e.isPlainObject(f[r])||n==o)return f[r]!==i?(s=f[r],!1):!1;f=f[r]}})),e.isFunction(s)?l=s.apply(r,n):s!==i&&(l=s),e.isArray(a)?a.push(l):a!==i?a=[a,l]:l!==i&&(a=l),s}},k?(R===i&&t.initialize(),t.invoke(b)):(R!==i&&R.invoke("destroy"),t.initialize())}),a!==i?a:this},e.fn.form.settings={name:"Form",namespace:"form",debug:!1,verbose:!0,performance:!0,keyboardShortcuts:!0,on:"submit",inline:!1,delay:200,revalidate:!0,transition:"scale",duration:200,onValid:function(){},onInvalid:function(){},onSuccess:function(){return!0},onFailure:function(){return!1},metadata:{defaultValue:"default",validate:"validate"},selector:{checkbox:'input[type="checkbox"], input[type="radio"]',clear:".clear",field:"input, textarea, select",group:".field",input:"input",message:".error.message",prompt:".prompt.label",radio:'input[type="radio"]',reset:".reset",submit:".submit",uiCheckbox:".ui.checkbox",uiDropdown:".ui.dropdown"},className:{error:"error",label:"ui prompt label",pressed:"down",success:"success"},error:{method:"The method you called is not defined."},templates:{error:function(t){var n='<ul class="list">';return e.each(t,function(e,t){n+="<li>"+t+"</li>"}),n+="</ul>",e(n)},prompt:function(t){return e("<div/>").addClass("ui red pointing prompt label").html(t[0])}},rules:{checked:function(){return e(this).filter(":checked").length>0},contains:function(e,t){return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),-1!==e.search(new RegExp(t,"i"))},containsExactly:function(e,t){return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),-1!==e.search(new RegExp(t))},email:function(e){var t=new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?","i");return t.test(e)},empty:function(e){return!(e===i||""===e)},integer:function(e,t){var n,r,a,o=/^\-?\d+$/;return t===i||""===t||".."===t||(-1==t.indexOf("..")?o.test(t)&&(n=r=t-0):(a=t.split("..",2),o.test(a[0])&&(n=a[0]-0),o.test(a[1])&&(r=a[1]-0))),o.test(e)&&(n===i||e>=n)&&(r===i||r>=e)},is:function(e,t){return t="string"==typeof t?t.toLowerCase():t,e="string"==typeof e?e.toLowerCase():e,e==t},isExactly:function(e,t){return e==t},length:function(e,t){return e!==i?e.length>=t:!1},match:function(t,n){var r,a=e(this);return a.find("#"+n).length>0?r=a.find("#"+n).val():a.find('[name="'+n+'"]').length>0?r=a.find('[name="'+n+'"]').val():a.find('[data-validate="'+n+'"]').length>0&&(r=a.find('[data-validate="'+n+'"]').val()),r!==i?t.toString()==r.toString():!1},maxLength:function(e,t){return e!==i?e.length<=t:!1},not:function(e,t){return e="string"==typeof e?e.toLowerCase():e,t="string"==typeof t?t.toLowerCase():t,e!=t},notExactly:function(e,t){return e!=t},url:function(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)}}}}(jQuery,window,document),function(e,t,n){"use strict";e.formData=e.fn.formData=function(t,i,r,a){var o,s,l,f,c,u;if("render"===t){if(s=i,f=e.fn.formData.callbacks.render[s.type])return f(s);var d=s.placeholder||s.label,m=!1;u='<div class="field">';for(var p=0;p<s.rules.length;++p)if("empty"===s.rules[p].type){m=!0;break}return u+='<label for="'+s.identifier+'">'+s.label+"</label>",u+=s.icon?'<div class="ui left labeled icon input">':'<div class="ui labeled input">',u+='<input type="text" id="'+s.identifier+'" name="'+s.identifier+'" placeholder="'+d+'" />',s.icon&&(u+='<i class="'+s.icon+' icon"></i>'),m&&(u+='<div class="ui corner label"><i class="icon asterisk"></i></div>'),u+="</div></div>"}if("set"===t||"setup"===t){var v;r=r||{};for(o in i)if(s=i[o],l=this.form("get field",s.identifier),0!==l.parent().length)if(c=r[o]||s.defaultValue,void 0===c&&(c=""),f=e.fn.formData.callbacks.set[s.type]){if(!(e.fn.formData.settings.noISODates||c instanceof Date))switch(s.type){case"date":c=new Date(parseInt(c.substr(0,4)),parseInt(c.substr(5,2))-1,parseInt(c.substr(8,2)),0,0,0,0);break;case"datetime":c=new Date(c)}v=f(s,l,c),v&&(e.fn.formData.objects[s.identifier]=v)}else switch(s.type){case"bool":l[0].checked=c?!0:!1;break;default:l.val(c)}return this}if("get"===t){for(o in i)if(s=i[o],l=this.form("get field",s.identifier),0!==l.parent().length)if(f=e.fn.formData.callbacks.get[s.type]){if(c=f(s,l,e.fn.formData.objects[s.identifier]),c instanceof Date&&("datetime"===s.type&&e.fn.formData.settings.timezoneOffset&&c.getTimezoneOffset()!==e.fn.formData.settings.timezoneOffset&&c.setMinutes(c.getMinutes()+(c.getTimezoneOffset()-e.fn.formData.settings.timezoneOffset)),!e.fn.formData.settings.noISODates)){var g=function(e){return 1==e.length?"0"+e:""+e};switch(s.type){case"date":c=c.getFullYear()+"-"+g(c.getMonth()+1)+"-"+g(c.getDate());break;case"datetime":c=c.toISOString().replace(/\.\d*/,"");break;case"time":c=g(c.getHours())+":"+g(c.getMinutes())+":"+g(c.getSeconds())}}r[o]=c}else switch(s.type){case"integer":r[o]=parseInt(l.val());break;case"decimal":r[o]=parseFloat(l.val());break;case"bool":r[o]=l[0].checked;break;default:r[o]=l.val()}return this}if("modal"===t){var h,b,k={},y={};r=r||{},a&&a.form&&(k=a.form),a&&a.modal&&(y=a.modal),u='<div id="modal-formdata" class="ui modal"><i class="close icon"></i><div class="ui header">'+a.title,a&&a.subtitle&&(u+='<div class="sub header">'+a.subtitle+"</div>"),u+='</div><div id="form-modal-formdata" class="ui form content">';for(o in i)u+=e.formData("render",i[o]);h="Submit",a&&a.submitButton&&(h=a.submitButton),u+=0===h.indexOf("<")?h:'<div class="ui right floated positive large submit button">'+h+"</div>",u+="</div></div>",e(n.body).append(u),k.onSuccess=function(){e(this).formData("get",i,r),a.onSuccess.call(this,r),e("#modal-formdata").modal("hide")},b=e("#form-modal-formdata"),b.form(i,k),b.formData("set",i,r),y.onHidden=function(){e(this).remove()},e("#modal-formdata").modal("setting",y).modal("show")}},e.fn.formData.settings={},e.fn.formData.objects={},e.fn.formData.callbacks={render:{bool:function(e){var t='<div class="field"><div class="ui toggle checkbox">';return t+='<input type="checkbox" id="'+e.identifier+'" name="'+e.identifier+'" />',t+='<label for="'+e.identifier+'">'+e.label+"</label>",t+="</div></div>"},text:function(e){var t='<div class="field">';return t+='<label for="'+e.identifier+'">'+e.label+"</label>",t+='<textarea id="'+e.identifier+'" name="'+e.identifier+'"></textarea>',t+="</div>"},choices:function(e){var t,n;t='<div class="field"><label>'+e.label+"</label>",t+='<div class="ui selection dropdown"><input type="hidden" id="'+e.identifier+'" name="'+e.identifier+'" />',t+='<div class="default text">'+e.label+"</div>",t+='<i class="dropdown icon"></i>',t+='<div class="menu">';for(n in e.choices)t+='<div class="item" data-value="'+n+'">'+e.choices[n]+"</div>";return t+="</div></div></div>"}},set:{choices:function(e,t,n){t.val(n),t.parent().dropdown()}},get:{}},e.fn.form.settings.rules.integer=function(e){return null!==e.match(/^[\+-]?\d*$/)},e.fn.form.settings.rules.decimal=function(e){var t=e.match(/^[\+-]?\d*$/);return null!==t?!0:null!==e.match(/^[\+-]?\d*\.\d*$/)},e.fn.form.settings.rules.min=function(e,t){return e>=parseInt(t)},e.fn.form.settings.rules.max=function(e,t){return e<=parseInt(t)},e.fn.form.settings.rules.regex=function(e,t){return null!==e.match(t)},e.fn.formData._emailRule=e.fn.form.settings.rules.email,e.fn.formData._urlRule=e.fn.form.settings.rules.url,e.fn.form.settings.rules.email=function(t){return e.fn.formData.settings.noEmptyFix||void 0!==t&&""!==t?e.fn.formData._emailRule.call(this,t):!0},e.fn.form.settings.rules.url=function(t){return e.fn.formData.settings.noEmptyFix||void 0!==t&&""!==t?e.fn.formData._urlRule.call(this,t):!0},e.fn.formData._dateRule=function(t,n){var i=e(t.parents(".ui.form")[0]).form("get validation",t),r=e.fn.formData.callbacks.get[i.type];if(r){var a=r(i,t,e.fn.formData.objects[i.identifier]),o=new Date;switch(i.type){case"date":n?(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):(o.setHours(23),o.setMinutes(59),o.setSeconds(59),o.setMilliseconds(999));break;case"datetime":e.fn.formData.settings.timezoneOffset&&a.getTimezoneOffset()!==e.fn.formData.settings.timezoneOffset&&a.setMinutes(a.getMinutes()+(a.getTimezoneOffset()-e.fn.formData.settings.timezoneOffset));break;default:return!0}return n?o>a:a>o}return!0},e.fn.form.settings.rules.past=function(t){return e.fn.formData._dateRule(this,!0)},e.fn.form.settings.rules.future=function(t){return e.fn.formData._dateRule(this,!1)},e.fn.form.settings.rules.order=function(t,n){var i=this;n=n.split(",");var r=i.form("get field",n[0]),a=i.form("get validation",r),o=i.form("get field",n[1]),s=i.form("get validation",o),l=e.fn.formData.callbacks.get[a.type];if(l){var f,c=l(a,r,e.fn.formData.objects[n[0]]),u=l(s,o,e.fn.formData.objects[n[1]]);return c&&u?f=u>c:!0}return!0}}(jQuery,window,document);