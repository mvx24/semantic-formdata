!function(e,t,i){"use strict";e.formData=e.fn.formData=function(t,a,n,s){var r,f,o,l,d,c;if("render"===t){if(f=a,l=e.fn.formData.callbacks.render[f.type])return l(f);var u=f.placeholder||f.label,m=!1;c='<div class="field">';for(var v=0;v<f.rules.length;++v)if("empty"===f.rules[v].type){m=!0;break}return c+='<label for="'+f.identifier+'">'+f.label+"</label>",c+=f.icon?'<div class="ui left labeled icon input">':'<div class="ui labeled input">',c+='<input type="text" id="'+f.identifier+'" name="'+f.identifier+'" placeholder="'+u+'" />',f.icon&&(c+='<i class="'+f.icon+' icon"></i>'),m&&(c+='<div class="ui corner label"><i class="icon asterisk"></i></div>'),c+="</div></div>"}if("set"===t||"setup"===t){var g;n=n||{};for(r in a)if(f=a[r],o=this.form("get field",f.identifier),0!==o.parent().length)if(d=n[r]||f.defaultValue,void 0===d&&(d=""),l=e.fn.formData.callbacks.set[f.type]){if(!(e.fn.formData.settings.noISODates||d instanceof Date))switch(f.type){case"date":d=new Date(parseInt(d.substr(0,4)),parseInt(d.substr(5,2))-1,parseInt(d.substr(8,2)),0,0,0,0);break;case"datetime":d=new Date(d)}g=l(f,o,d),g&&(e.fn.formData.objects[f.identifier]=g)}else switch(f.type){case"bool":o[0].checked=d?!0:!1;break;default:o.val(d)}return this}if("get"===t){for(r in a)if(f=a[r],o=this.form("get field",f.identifier),0!==o.parent().length)if(l=e.fn.formData.callbacks.get[f.type]){if(d=l(f,o,e.fn.formData.objects[f.identifier]),d instanceof Date&&("datetime"===f.type&&e.fn.formData.settings.timezoneOffset&&d.getTimezoneOffset()!==e.fn.formData.settings.timezoneOffset&&d.setMinutes(d.getMinutes()+(d.getTimezoneOffset()-e.fn.formData.settings.timezoneOffset)),!e.fn.formData.settings.noISODates)){var b=function(e){return 1==e.length?"0"+e:""+e};switch(f.type){case"date":d=d.getFullYear()+"-"+b(d.getMonth()+1)+"-"+b(d.getDate());break;case"datetime":d=d.toISOString().replace(/\.\d*/,"");break;case"time":d=b(d.getHours())+":"+b(d.getMinutes())+":"+b(d.getSeconds())}}n[r]=d}else switch(f.type){case"integer":n[r]=parseInt(o.val());break;case"decimal":n[r]=parseFloat(o.val());break;case"bool":n[r]=o[0].checked;break;default:n[r]=o.val()}return this}if("modal"===t){var p,D,h={},k={};n=n||{},s&&s.form&&(h=s.form),s&&s.modal&&(k=s.modal),c='<div id="modal-formdata" class="ui modal"><i class="close icon"></i><div class="ui header">'+s.title,s&&s.subtitle&&(c+='<div class="sub header">'+s.subtitle+"</div>"),c+='</div><div id="form-modal-formdata" class="ui form content">';for(r in a)c+=e.formData("render",a[r]);p="Submit",s&&s.submitButton&&(p=s.submitButton),c+=0===p.indexOf("<")?p:'<div class="ui right floated positive large submit button">'+p+"</div>",c+="</div></div>",e(i.body).append(c),h.onSuccess=function(){e(this).formData("get",a,n),s.onSuccess.call(this,n),e("#modal-formdata").modal("hide")},D=e("#form-modal-formdata"),D.form(a,h),D.formData("set",a,n),k.onHidden=function(){e(this).remove()},e("#modal-formdata").modal("setting",k).modal("show")}},e.fn.formData.settings={},e.fn.formData.objects={},e.fn.formData.callbacks={render:{bool:function(e){var t='<div class="field"><div class="ui toggle checkbox">';return t+='<input type="checkbox" id="'+e.identifier+'" name="'+e.identifier+'" />',t+='<label for="'+e.identifier+'">'+e.label+"</label>",t+="</div></div>"},text:function(e){var t='<div class="field">';return t+='<label for="'+e.identifier+'">'+e.label+"</label>",t+='<textarea id="'+e.identifier+'" name="'+e.identifier+'"></textarea>',t+="</div>"},choices:function(e){var t,i;t='<div class="field"><label>'+e.label+"</label>",t+='<div class="ui selection dropdown"><input type="hidden" id="'+e.identifier+'" name="'+e.identifier+'" />',t+='<div class="default text">'+e.label+"</div>",t+='<i class="dropdown icon"></i>',t+='<div class="menu">';for(i in e.choices)t+='<div class="item" data-value="'+i+'">'+e.choices[i]+"</div>";return t+="</div></div></div>"}},set:{choices:function(e,t,i){t.val(i),t.parent().dropdown()}},get:{}},e.fn.form.settings.rules.integer=function(e){return null!==e.match(/^[\+-]?\d*$/)},e.fn.form.settings.rules.decimal=function(e){var t=e.match(/^[\+-]?\d*$/);return null!==t?!0:null!==e.match(/^[\+-]?\d*\.\d*$/)},e.fn.form.settings.rules.min=function(e,t){return e>=parseInt(t)},e.fn.form.settings.rules.max=function(e,t){return e<=parseInt(t)},e.fn.form.settings.rules.regex=function(e,t){return null!==e.match(t)},e.fn.formData._emailRule=e.fn.form.settings.rules.email,e.fn.formData._urlRule=e.fn.form.settings.rules.url,e.fn.form.settings.rules.email=function(t){return e.fn.formData.settings.noEmptyFix||void 0!==t&&""!==t?e.fn.formData._emailRule.call(this,t):!0},e.fn.form.settings.rules.url=function(t){return e.fn.formData.settings.noEmptyFix||void 0!==t&&""!==t?e.fn.formData._urlRule.call(this,t):!0},e.fn.formData._dateRule=function(t,i){var a=e(t.parents(".ui.form")[0]).form("get validation",t),n=e.fn.formData.callbacks.get[a.type];if(n){var s=n(a,t,e.fn.formData.objects[a.identifier]),r=new Date;switch(a.type){case"date":i?(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)):(r.setHours(23),r.setMinutes(59),r.setSeconds(59),r.setMilliseconds(999));break;case"datetime":e.fn.formData.settings.timezoneOffset&&s.getTimezoneOffset()!==e.fn.formData.settings.timezoneOffset&&s.setMinutes(s.getMinutes()+(s.getTimezoneOffset()-e.fn.formData.settings.timezoneOffset));break;default:return!0}return i?r>s:s>r}return!0},e.fn.form.settings.rules.past=function(t){return e.fn.formData._dateRule(this,!0)},e.fn.form.settings.rules.future=function(t){return e.fn.formData._dateRule(this,!1)},e.fn.form.settings.rules.order=function(t,i){var a=this;i=i.split(",");var n=a.form("get field",i[0]),s=a.form("get validation",n),r=a.form("get field",i[1]),f=a.form("get validation",r),o=e.fn.formData.callbacks.get[s.type];if(o){var l,d=o(s,n,e.fn.formData.objects[i[0]]),c=o(f,r,e.fn.formData.objects[i[1]]);return d&&c?l=c>d:!0}return!0}}(jQuery,window,document);